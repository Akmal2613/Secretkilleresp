local function analyzePlayerInventory(player)
    local function checkItem(itemName)
        local inventory = player.Backpack:GetChildren()
        local character = player.Character
        for _, item in pairs(inventory) do
            if item.Name == itemName then
                return true
            end
        end
        if character then
            for _, item in pairs(character:GetChildren()) do
                if item:IsA("Tool") and item.Name == itemName then
                    return true
                end
            end
        end
        return false
    end

    local hasMonster = checkItem("Monster")
    local hasGun = checkItem("Gun")

    if hasMonster or hasGun then
        local highlight = player.Character:FindFirstChild("Highlight")
        if not highlight then
            highlight = Instance.new("Highlight")
            highlight.Adornee = player.Character
            highlight.Parent = player.Character
        end

        if hasMonster then
            highlight.FillColor = Color3.new(1, 0, 0)
        elseif hasGun then
            highlight.FillColor = Color3.new(0, 0, 1)
        end
    else
        local highlight = player.Character and player.Character:FindFirstChild("Highlight")
        if highlight then
            highlight:Destroy()
        end
    end
end
